<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>원천 징수부</title>

    <link rel="stylesheet" type="text/css" th:href="@{/bootstrapLux.css}">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <!-- 네비게이션바 프라그먼트-->
    <nav th:replace="~{/navbar :: navbarFragment}"></nav>

    <div class="container-fluid">
        <div class="row">

            <!-- 아코디언 메뉴 칼럼 프라그먼트 (5분의 1 크기) -->
            <div class="col-lg-2">
                <div th:replace="~{ac/AC_arcodian :: arcodianFragment}"></div>
            </div>
            <!-- 등록 컬럼 (1:4 비율) -->
            <div class="col-lg-10">
				<!--여기에 검색폼 만들기-->
				<form action="" method="get">
				    <label for="searchInput" class="form-label">테이블 검색</label>
				    <input class="form-control me-sm-2" type="search" id="searchInput" placeholder="검색어를 입력하세요">
				    <button type="button" class="btn btn-primary" onclick="searchTable()">검색</button>
				</form>
				<table class = "table table-hover">
					<thead>
				        <tr class="table-active">
							<th>사원</th>
			                <th>월 급여</th>
			                <th>국민연금</th>
			                <th>건강보험</th>
			                <th>장기요양</th>
			                <th>고용보험</th>
			                <th>소득세</th>
			                <th>공제액 합계</th>
			                <th>실수령액</th>
			            </tr>
			        </thead>
			        <tbody>
			            <!-- for each 문 -->
			            <tr th:each="withholding : ${withholdings}">
			                <!-- 화면에 띄울 정보 -->
			                <td th:text="${withholding.name}"></td>
			                <td th:text="${#numbers.formatInteger(withholding.results[0], 3, 'COMMA')}"></td>
			                <td th:text="${#numbers.formatInteger(withholding.results[1], 3, 'COMMA')}"></td>
			                <td th:text="${#numbers.formatInteger(withholding.results[2], 3, 'COMMA')}"></td>
			                <td th:text="${#numbers.formatInteger(withholding.results[3], 3, 'COMMA')}"></td>
			                <td th:text="${#numbers.formatInteger(withholding.results[4], 3, 'COMMA')}"></td>
			                <td th:text="${#numbers.formatInteger(withholding.results[5], 3, 'COMMA')}"></td>
			                <td th:text="${#numbers.formatInteger(withholding.results[6], 3, 'COMMA')}"></td>
			                <td th:text="${#numbers.formatInteger(withholding.results[7], 3, 'COMMA')}"></td>
			            </tr>
			        </tbody>
			    </table>			    
			    <!-- 페이징 프라그먼트 -->
				<div th:replace="~{/paging::pagingFragment(paging=${withholdings})}"></div>
            </div> <!-- 등록 컬럼 끝(1:4 비율) -->
        </div> <!-- 컨테이너 플루이드 정의 끝 -->
    </div> <!-- 컨테이너 플루이드 끝 -->
    <!-- Bootstrap JS 연결 -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
	    function searchTable() {
		    // 입력된 검색어 가져오기
		    var input, filter, table, tr, td, i, txtValue;
		    input = document.getElementById("searchInput");
		    filter = input.value.toUpperCase();
		    table = document.getElementById("dataTable");
		    tr = table.getElementsByTagName("tr");
		
		    // 각 행을 반복하며 필터링 적용
		    for (i = 0; i < tr.length; i++) {
		        // 각 열에 대해 검색어와 일치하는지 확인
		        td = tr[i].getElementsByTagName("td");
		        for (var j = 0; j < td.length; j++) {
		            if (td[j]) {
		                txtValue = td[j].textContent || td[j].innerText;
		                if (txtValue.toUpperCase().indexOf(filter) > -1) {
		                    tr[i].style.display = "";
		                    break; // 일치하는 열이 있으면 다음 행으로 이동
		                } else {
		                    tr[i].style.display = "none"; // 일치하지 않으면 행 숨기기
		                }
		            }
		        }
		    }
		}
	</script>
</body>
</html>